<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Pubsub - pymsgbus</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Pubsub";
        var mkdocs_page_input_path = "pubsub.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> pymsgbus
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../events/">Events</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Pubsub</a>
    <ul class="current">
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../services/">Services</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../callbacks/">Callbacks</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../types/">Types</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">pymsgbus</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Pubsub</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h3 id="delivering-messages-with-the-publishersubscriber-pattern">Delivering messages with the publisher/subscriber pattern.</h3>


<div class="doc doc-object doc-module">



<a id="pymsgbus.publisher"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pymsgbus.publisher.Publisher" class="doc doc-heading">
            <code>Publisher</code>


</h2>


    <div class="doc doc-contents ">


        <p>A PUBLISHER is a component that publishes messages to a group of SUBSCRIBERS. It is
responsible for transmitting information from within an Aggregate to the outside of the
BOUNDED CONTEXT. </p>
<p>Unlike an PRODUCER, a PUBLISHER publishes messages into defined topics, which are then
received by SUBSCRIBERS that have registered to listen to those topics.</p>
<p>Example:</p>
<pre><code>.. code-block:: python

from pymsgbus import Subscriber
from pymsgbus import Publisher
subscriber = Subscriber()

...

publisher = Publisher()
publisher.register(subscriber)
publisher.publish('topic-1', 'Hello')
publisher.publish('topic-2', 'World')
</code></pre>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pymsgbus.publisher.Publisher.publish" class="doc doc-heading">
            <code class="highlight language-python">publish(topic, message)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Publishes a message to all registered SUBSCRIBERS.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>topic</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>The topic of the message.</p>
              </div>
            </li>
            <li>
              <b><code>message</code></b>
                  (<code><a class="autorefs autorefs-internal" title="pymsgbus.models.Message" href="../types/#pymsgbus.models.Message">Message</a> | <span title="typing.Any">Any</span></code>)
              –
              <div class="doc-md-description">
                <p>The message to publish.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymsgbus.publisher.Publisher.register" class="doc doc-heading">
            <code class="highlight language-python">register(*subscribers)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds a group of SUBSCRIBERS to the PUBLISHER.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>*subscribers</code></b>
                  (<code><a class="autorefs autorefs-internal" title="pymsgbus.publisher.Subscriber" href="#pymsgbus.publisher.Subscriber">Subscriber</a></code>, default:
                      <code>()</code>
)
              –
              <div class="doc-md-description">
                <p>the subscribers to register</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pymsgbus.publisher.Subscriber" class="doc doc-heading">
            <code>Subscriber</code>


</h2>


    <div class="doc doc-contents ">


        <p>A SUBSCRIBER is a component that listens for messages published by an Aggregate and
processes them accordingly.</p>
<p>Unlike a CONSUMER, a SUBSCRIBER is responsible for processing messages based on the
topic they were published to. It means that the publisher is responsible for deciding
which handlers to invoke based on the topic of the message.</p>
<p>Methods:</p>
<pre><code>register(topic: str, handler: Callable):
    Registers a message type and its corresponding handler function.

subscribe(topics):
    Decorator for registering a handler function to one or more topics.

receive(topic: str, message: Any):
    Receives a message from a given topic and triggers the corresponding handler functions
    to process it.
</code></pre>
<p>Example:</p>
<pre><code>.. code-block:: python

from pymsgbus import Subscriber
from pymsgbus import Publisher
from pymsgbus import Depends

subscriber = Subscriber()
notifications = []
database = []

def get_db():
    return database

@subscriber.subscribe('topic-1', 'topic-2')
def callback(message):
    notifications.append(message)

@subscriber.subscribe('topic-2')
def second_callback(message, db = Depends(get_db)): # Like FastAPI's Depends
    database.append(message)

publisher = Publisher()
publisher.register(subscriber)
publisher.publish('topic-1', 'Hello')
publisher.publish('topic-2', 'World')
assert database == ['World']
assert notifications == ['Hello', 'World']
</code></pre>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pymsgbus.publisher.Subscriber.handler" class="doc doc-heading">
            <code class="highlight language-python">handler(*topics)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Decorator for registering a handler function to one or more topics.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>topics</code></b>
                  (<code>str</code>, default:
                      <code>()</code>
)
              –
              <div class="doc-md-description">
                <p>The topics to subscribe to.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>Callable</code></b>(                  <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="pymsgbus.models.Message" href="../types/#pymsgbus.models.Message">Message</a> | <span title="typing.Any">Any</span>], None]</code>
)              –
              <div class="doc-md-description">
                <p>The original handler function, unmodified.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymsgbus.publisher.Subscriber.receive" class="doc doc-heading">
            <code class="highlight language-python">receive(topic, message)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Receives a message from a given topic and triggers the corresponding handler functions
to process it.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>topic</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>The topic of the message.</p>
              </div>
            </li>
            <li>
              <b><code>message</code></b>
                  (<code><a class="autorefs autorefs-internal" title="pymsgbus.models.Message" href="../types/#pymsgbus.models.Message">Message</a> | <span title="typing.Any">Any</span></code>)
              –
              <div class="doc-md-description">
                <p>The message to process.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymsgbus.publisher.Subscriber.register" class="doc doc-heading">
            <code class="highlight language-python">register(topic, subscriber)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Registers a message type and its corresponding handler function.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>topic</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>The topic to register.</p>
              </div>
            </li>
            <li>
              <b><code>subscriber</code></b>
                  (<code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="pymsgbus.models.Message" href="../types/#pymsgbus.models.Message">Message</a>], None]</code>)
              –
              <div class="doc-md-description">
                <p>The handler function for the message.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymsgbus.publisher.Subscriber.subscribe" class="doc doc-heading">
            <code class="highlight language-python">subscribe(*topics)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Decorator for registering a handler function to one or more topics.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>topics</code></b>
                  (<code>str</code>, default:
                      <code>()</code>
)
              –
              <div class="doc-md-description">
                <p>The topics to subscribe to.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>Callable</code></b>(                  <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="pymsgbus.models.Message" href="../types/#pymsgbus.models.Message">Message</a> | <span title="typing.Any">Any</span>], None]</code>
)              –
              <div class="doc-md-description">
                <p>The original handler function, unmodified.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../events/" class="btn btn-neutral float-left" title="Events"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../services/" class="btn btn-neutral float-right" title="Services">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../events/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../services/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
